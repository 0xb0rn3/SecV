{
  "name": "mac_spoof",
  "version": "2.0.0",
  "category": "network",
  "description": "Automated MAC address spoofer with background daemon support and graceful state management",
  "author": "0xb0rn3 (oxbv1) - Enhanced",
  "executable": "python3 mac_spoof.py",
  
  "dependencies": [
    "python3"
  ],
  
  "optional_dependencies": {},
  
  "help": {
    "description": "Automated MAC address spoofer that randomizes the last 3 octets while keeping a locally-administered OUI prefix (02:00:00). Launches background daemon per interface to change MAC at configurable intervals. Supports start/stop/status, all-up interfaces, and multi-interface lists. State is tracked in ~/.secv/mac_spoof/ for persistence.",
    
    "parameters": {
      "iface": {
        "description": "Interface name or comma-separated list. Leave empty to prompt or use all_up",
        "type": "string",
        "examples": ["wlan0", "eth0", "eth0,wlan0"],
        "required": false
      },
      "all_up": {
        "description": "If true, select all non-loopback interfaces currently UP",
        "type": "boolean",
        "options": ["true", "false"],
        "default": "false"
      },
      "action": {
        "description": "Operation to perform on the spoofer",
        "type": "string",
        "options": ["start", "stop", "status"],
        "default": "start",
        "examples": ["start", "stop", "status"]
      },
      "dry_run": {
        "description": "If true, preview actions without making changes",
        "type": "boolean",
        "options": ["true", "false"],
        "default": "false"
      },
      "interval": {
        "description": "Seconds between MAC address changes",
        "type": "number",
        "default": "0.5",
        "range": "0.1-60",
        "examples": ["0.5", "1.0", "5.0"]
      }
    },
    
    "examples": [
      {
        "description": "Start automated spoofing on wlan0",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "run target"
        ]
      },
      {
        "description": "Start spoofing on multiple interfaces",
        "commands": [
          "use mac_spoof",
          "set iface eth0,wlan0",
          "run target"
        ]
      },
      {
        "description": "Start spoofing on all UP interfaces",
        "commands": [
          "use mac_spoof",
          "set all_up true",
          "run target"
        ]
      },
      {
        "description": "Stop spoofing on wlan0 (restores original MAC)",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "set action stop",
          "run target"
        ]
      },
      {
        "description": "Check status of all running spoofers",
        "commands": [
          "use mac_spoof",
          "set action status",
          "set all_up true",
          "run target"
        ]
      },
      {
        "description": "Preview changes with dry run mode",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "set dry_run true",
          "run target"
        ]
      },
      {
        "description": "Slower MAC rotation (every 5 seconds)",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "set interval 5.0",
          "run target"
        ]
      }
    ],
    
    "features": [
      "Per-interface background daemon (one process per interface)",
      "Locally-administered OUI prefix (02:00:00) to reduce conflicts",
      "Saves and restores original MAC addresses",
      "Supports single interface, multiple interfaces, or all UP interfaces",
      "Status tracking with persistent state files",
      "Dry-run mode for safe testing",
      "Configurable MAC rotation interval",
      "Graceful daemon management with proper cleanup"
    ],
    
    "installation_tiers": {
      "basic": "Full functionality - only requires Python 3 stdlib and iproute2",
      "standard": "Same as basic - no additional dependencies needed",
      "full": "Same as basic - no additional dependencies needed"
    },
    
    "notes": [
      "âš  Requires root/sudo privileges for MAC address changes",
      "âš  Rapidly changing MACs will break active connections (DHCP, WiFi associations)",
      "âš  Use only in authorized lab environments or with proper authorization",
      "âš  Some network drivers may not handle frequent MAC changes well",
      "âš  Currently supports Linux only (using iproute2)",
      "âš  Each interface spoofer runs independently; stopping restores original MAC",
      "âš  State files stored in ~/.secv/mac_spoof/ for tracking daemons",
      "ðŸ’¡ Use 'dry_run true' to preview actions before execution",
      "ðŸ’¡ Use slower intervals (5+ seconds) for better driver compatibility",
      "ðŸ’¡ Check status regularly to ensure daemons are running properly"
    ]
  },
  
  "inputs": {
    "iface": {
      "type": "string",
      "description": "Interface name or comma-separated list",
      "required": false,
      "default": ""
    },
    "all_up": {
      "type": "boolean",
      "description": "Select all UP interfaces",
      "required": false,
      "default": false
    },
    "action": {
      "type": "string",
      "description": "Action: start, stop, or status",
      "required": false,
      "default": "start"
    },
    "dry_run": {
      "type": "boolean",
      "description": "Preview mode without changes",
      "required": false,
      "default": false
    },
    "interval": {
      "type": "number",
      "description": "Seconds between MAC changes",
      "required": false,
      "default": 0.5
    }
  },
  
  "outputs": {
    "action": {
      "type": "string",
      "description": "Action that was performed"
    },
    "results": {
      "type": "object",
      "description": "Per-interface operation results"
    },
    "dry_run": {
      "type": "boolean",
      "description": "Whether this was a dry run"
    }
  },
  
  "timeout": 30,
  "concurrent": false
}
