{
  "name": "mac_spoof",
  "version": "2.1.0",
  "category": "network",
  "description": "Connection-aware MAC spoofer with smart rotation modes to minimize disruption",
  "author": "0xb0rn3 (oxbv1) - Connection-Preserving Edition",
  "executable": "python3 mac_spoof.py",
  
  "dependencies": [
    "python3"
  ],
  
  "optional_dependencies": {
    "psutil": "For connection tracking - pip3 install psutil --user --break-system-packages"
  },
  
  "help": {
    "description": "Enhanced MAC spoofer that tracks active TCP connections and intelligently rotates MAC addresses to minimize disruption. Features multiple spoofing modes: smart (changes only when idle), session (changes between connection sessions), periodic (timed with connection checks), and aggressive (rapid changes). Uses locally-administered OUI prefix (02:00:00) and includes graceful DHCP renewal.",
    
    "parameters": {
      "iface": {
        "description": "Interface name or comma-separated list",
        "type": "string",
        "examples": ["wlan0", "eth0", "eth0,wlan0"],
        "required": false
      },
      "all_up": {
        "description": "If true, select all non-loopback interfaces currently UP",
        "type": "boolean",
        "options": ["true", "false"],
        "default": "false"
      },
      "action": {
        "description": "Operation to perform",
        "type": "string",
        "options": ["start", "stop", "status"],
        "default": "start"
      },
      "mode": {
        "description": "Spoofing mode strategy",
        "type": "string",
        "options": ["smart", "session", "periodic", "aggressive"],
        "default": "smart",
        "examples": [
          "smart - Changes only when no active connections (safest)",
          "session - Changes between connection sessions",
          "periodic - Fixed intervals with connection checks",
          "aggressive - Rapid changes (may break connections)"
        ]
      },
      "interval": {
        "description": "Seconds between MAC changes (increased default for stability)",
        "type": "number",
        "default": "30.0",
        "range": "5.0-3600",
        "examples": ["30.0", "60.0", "300.0"]
      },
      "preserve_connections": {
        "description": "Protect active connections from disruption",
        "type": "boolean",
        "options": ["true", "false"],
        "default": "true"
      },
      "wait_for_quiet": {
        "description": "Wait for connections to close before changing MAC",
        "type": "boolean",
        "options": ["true", "false"],
        "default": "true"
      },
      "max_wait": {
        "description": "Maximum seconds to wait for quiet period",
        "type": "integer",
        "default": "30",
        "range": "5-300"
      },
      "dry_run": {
        "description": "Preview actions without making changes",
        "type": "boolean",
        "options": ["true", "false"],
        "default": "false"
      }
    },
    
    "examples": [
      {
        "description": "Smart mode - safest for daily use",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "set mode smart",
          "set interval 60",
          "run target"
        ]
      },
      {
        "description": "Session mode - good for web browsing",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "set mode session",
          "run target"
        ]
      },
      {
        "description": "Periodic with long interval",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "set mode periodic",
          "set interval 300",
          "run target"
        ]
      },
      {
        "description": "Multiple interfaces with connection protection",
        "commands": [
          "use mac_spoof",
          "set iface eth0,wlan0",
          "set mode smart",
          "set preserve_connections true",
          "run target"
        ]
      },
      {
        "description": "Check detailed status with connection info",
        "commands": [
          "use mac_spoof",
          "set action status",
          "set all_up true",
          "run target"
        ]
      },
      {
        "description": "Stop spoofer and restore original MAC",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "set action stop",
          "run target"
        ]
      },
      {
        "description": "Preview changes with dry run",
        "commands": [
          "use mac_spoof",
          "set iface wlan0",
          "set mode smart",
          "set dry_run true",
          "run target"
        ]
      }
    ],
    
    "features": [
      "Connection-aware MAC rotation (tracks active TCP connections)",
      "Multiple spoofing modes: smart, session, periodic, aggressive",
      "Graceful DHCP renewal after MAC changes",
      "Configurable wait periods for connection closure",
      "Active connection monitoring and counting",
      "Session detection for intelligent timing",
      "Change counter tracking total rotations",
      "Locally-administered OUI prefix (02:00:00)",
      "Per-interface background daemons",
      "State persistence with detailed metrics",
      "Dry-run mode for safe testing",
      "Minimal connection disruption"
    ],
    
    "modes_explained": {
      "smart": {
        "description": "Safest mode - only changes MAC when interface is idle",
        "behavior": "Requires 3 consecutive quiet checks (15s total) before changing",
        "use_case": "Daily use, active SSH/database sessions, file transfers",
        "disruption": "None - waits for complete idle state"
      },
      "session": {
        "description": "Changes MAC between connection sessions",
        "behavior": "Waits 10 seconds after all connections close, then changes",
        "use_case": "Web browsing, email checking, intermittent network use",
        "disruption": "Minimal - only affects reconnection timing"
      },
      "periodic": {
        "description": "Timed rotation with connection awareness",
        "behavior": "Changes at fixed intervals but waits if connections active",
        "use_case": "Moderate activity with predictable timing needs",
        "disruption": "Low - respects preserve_connections setting"
      },
      "aggressive": {
        "description": "Rapid rotation regardless of connections",
        "behavior": "Changes every interval without waiting",
        "use_case": "Lab testing only, maximum anonymity needs",
        "disruption": "High - will break active connections"
      }
    },
    
    "installation_tiers": {
      "basic": "Full functionality with psutil installed",
      "standard": "Same as basic - no additional dependencies",
      "full": "Same as basic - no additional dependencies"
    },
    
    "notes": [
      "‚ö†Ô∏è  Requires root/sudo privileges for MAC address changes",
      "‚ö†Ô∏è  Requires psutil: pip3 install psutil --user --break-system-packages",
      "‚ö†Ô∏è  'smart' and 'session' modes recommended for active use",
      "‚ö†Ô∏è  'aggressive' mode will break active connections",
      "‚ö†Ô∏è  DHCP renewal may cause brief traffic interruption",
      "‚ö†Ô∏è  Use only in authorized lab environments",
      "üí° Start with 'smart' mode and 60+ second intervals",
      "üí° Monitor status to see active connections count",
      "üí° Use dry_run to preview behavior before executing",
      "üí° Longer intervals (300+) provide better stability",
      "üí° Check 'total_changes' in status to track rotations",
      "üí° Stop spoofer cleanly before system shutdown"
    ]
  },
  
  "inputs": {
    "iface": {
      "type": "string",
      "description": "Interface name or comma-separated list",
      "required": false,
      "default": ""
    },
    "all_up": {
      "type": "boolean",
      "description": "Select all UP interfaces",
      "required": false,
      "default": false
    },
    "action": {
      "type": "string",
      "description": "Action: start, stop, or status",
      "required": false,
      "default": "start"
    },
    "mode": {
      "type": "string",
      "description": "Spoofing mode: smart, session, periodic, aggressive",
      "required": false,
      "default": "smart"
    },
    "interval": {
      "type": "number",
      "description": "Seconds between MAC changes",
      "required": false,
      "default": 30.0
    },
    "preserve_connections": {
      "type": "boolean",
      "description": "Protect active connections",
      "required": false,
      "default": true
    },
    "wait_for_quiet": {
      "type": "boolean",
      "description": "Wait for idle period",
      "required": false,
      "default": true
    },
    "max_wait": {
      "type": "integer",
      "description": "Maximum wait time (seconds)",
      "required": false,
      "default": 30
    },
    "dry_run": {
      "type": "boolean",
      "description": "Preview mode without changes",
      "required": false,
      "default": false
    }
  },
  
  "outputs": {
    "action": {
      "type": "string",
      "description": "Action that was performed"
    },
    "mode": {
      "type": "string",
      "description": "Spoofing mode used"
    },
    "results": {
      "type": "object",
      "description": "Per-interface operation results with connection info"
    },
    "dry_run": {
      "type": "boolean",
      "description": "Whether this was a dry run"
    }
  },
  
  "timeout": 30,
  "concurrent": false
}
